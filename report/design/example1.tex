\chapter{System identification}
\label{identification_design}

\emph{In this chapter, the Multi-inlet, Multi-WT model, which has been derived based on first principles in \chapref{system_modelling}, is reformulated such that it is suitable for system identification. First, the structure of the model is discussed, then a Neural Network(NN) based identification method is presented. In the first case, the identification is carried out on a simple example, then on the Randers WSS EPANET model. In the second case, the identification is carried out based on measurements from the real-world network.}

\section{Model structure of the Multi-inlet, Multi-WT system}
\label{model_structure_of_the_multi_inlet_multi_WT_system}

In \chapref{system_modelling}, the model of a multi-inlet WSS with the extension of multiple WTs has been derived. The presented model has been given by a non-linear SS representation, which consists of the equations describing the dynamics, the outputs and the constraints on the network. As the model derivation is based on first principles, some insight into the structure and the input-output relation is available. 

\subsection{Output equation}
\label{output_eq_identification}

The model needs to be identified in order to utilize it for control purposes. Therefore, let us recall the governing equations. The output vector $\bar{p}_{\mathcal{K}}$ of the inlet pressures is given in discrete form such that

\begin{equation}
  \label{recall_output_eq}
  \bar{p}_{\mathcal{K},k} = K^T \bar{H}^{-T}_{\mathcal{T}}f_{\mathcal{T}}(A_2 q_{\mathcal{C},k} + A_3 K \bar{d}_{\mathcal{K},k} - A_3 D v_{\mathcal{D}} \sigma_k) - K^T\bar{H}^{-T}_{\mathcal{T}}\hat{H}^{T}_{\mathcal{T}} (\hat{p}_k + \hat{h}) - K^T\bar{h} ,
\end{equation} 

\begin{minipage}[t]{0.4\textwidth}
where\\
\hspace*{8mm} $A_2 = -\bar{H}^{-1}_{\mathcal{T}} \bar{H}_{\mathcal{C}} $, \vspace*{1.5mm}\\
\hspace*{8mm} $A_3 = \bar{H}^{-1}_{\mathcal{T}}$,
\end{minipage}

and furthermore, $\bar{d}_{\mathcal{K},k}$ inlet flows, $\sigma_k$ total demand, $v_{\mathcal{D}}$ distribution parameter, $q_{\mathcal{C},k}$ flows in set $\mathcal{C}$, $\hat{p}_k$ pressures in the WTs, $\hat{h}$ elevations of the WTs and $K^T\bar{h} = \bar{h}_{\mathcal{K}} $ the elevations of the pumping stations. The corresponding values of the pressures and flows in the network are evaluated at each time step $k$. 

Additionally, let us recall the constraint on $q_\mathcal{C}$, and rewrite it in discrete-time form such that

 \begin{equation}
\label{recall_constraint eq}
f_{\mathcal{C}}(q_{\mathcal{C},k}) - A_1(\hat{p}_k + \hat{h}) + A_2^T f_{\mathcal{T}}(A_2 q_{\mathcal{C},k} + A_3 K \bar{d}_{\mathcal{K},k} - A_3 D v_{\mathcal{D}} \sigma_k) = 0.
\end{equation} 

It is important to point out that the model in \chapref{system_modelling} has been derived in a general manner, taking into account that $v_{\mathcal{D}}$ is a time-varying distribution parameter of the demands. However, in the further description, let us restrict ourselves and assume that $v_{\mathcal{D}}$ is constant.  From the technical point of view, the identification becomes less complex, as in this case $v_{\mathcal{D}}$ is a linear constant parameter. Furthermore, there is no need to introduce $v_{\mathcal{D}}$ as a time-varying parameter on the EPANET data, however on the real measurement data, the possible demand variations might be experienced. In \eqref{recall_constraint eq} and \eqref{recall_output_eq} the assumption of $v_{\mathcal{D}}$ being constant is already taken into account, therefore $v_{\mathcal{D}}$ does not have any time index.

% This assumption is beneficial from the system point of view, as the total consumption $\sigma_k$ can be represented simply by the sum of the hourly demand variations $1^T \bar{d}_{\mathcal{D}}$. 

The constraint on $q_\mathcal{C}$ in \eqref{recall_constraint eq} is given by an implicit expression for which an analytical soulution has not been derived. The explicit solution for the constraint has a structure like \eqref{qc_abstraction}, however we do not know how it looks exactly.

 \begin{equation}
\label{qc_abstraction}
q_{\mathcal{C},k} = q_\mathcal{C} \big( (\hat{p}_k + \hat{h}),\bar{d}_{\mathcal{K},k}, \sigma_k\big).
\end{equation} 

It is shown in \eqref{qc_abstraction} that the $q_\mathcal{C}$ flows in the network depend on the same physical measures, i.e. the same variables as the outputs $\bar{p}_{\mathcal{K}}$. By substituting \eqref{qc_abstraction} into \eqref{recall_output_eq}, we get the following output equation

\vspace{-4mm}
\begin{align}
  \label{recall_output_eq_2}
      \bar{p}_{\mathcal{K},k}  = & \nonumber K^T \bar{H}^{-T}_{\mathcal{T}}f_{\mathcal{T}} \big (A_2 q_{\mathcal{C}}\big ((\hat{p}_k + \hat{h}),\bar{d}_{\mathcal{K},k}, \sigma_k \big) + A_3 K \bar{d}_{\mathcal{K},k} - A_3 D v_{\mathcal{D}} \sigma_k \big)   \\ &  - K^T\bar{H}^{-T}_{\mathcal{T}}\hat{H}^{T}_{\mathcal{T}} (\hat{p}_k + \hat{h}) - \bar{h}_{\mathcal{K}} .
\end{align}

\vspace{-4mm}
In \eqref{recall_output_eq_2}, the pressure head in the pumping stations $\bar{p}_{\mathcal{K},k}$ is given by the expression on the right-hand side. Let us write \eqref{recall_output_eq_2} in a form where the non-linear expression on the right-hand side is replaced with a non-linear function $\tilde{f}_1(\cdot)$, which has an unknown structure but has the same variables in the argument. Thus, a reformulated output equation can be given such that 

 \begin{equation}
  \label{recall_output_eq_3}
     \bar{p}_{\mathcal{K},k}  = \tilde{f}_1 \big((\hat{p}_k + \hat{h}),\bar{d}_{\mathcal{K},k}, \sigma_k\big) + \tilde{a}_{\mathcal{K}} (\hat{p}_k + \hat{h}) - \bar{h}_{\mathcal{K}}, 
\end{equation} 

The output equation described in \eqref{recall_output_eq_3} is a mapping defined by the non-linear function $\tilde{f}_1$ and the linear term, which maps the input set, $u_k = ( \hat{p}_k\!+\!\hat{h} \ \bar{d}_{\mathcal{K},k} \ \sigma_k )^T$ to the outputs $\bar{p}_{\mathcal{K},k} $. Typically, the pressure is measured in the WTs not the total head, therefore the elevation $\bar{h}_{\mathcal{K}}$ is not added to $\bar{p}_{\mathcal{K},k}$ on the left-hand side in \eqref{recall_output_eq_3}. In the input set, the total consumption can be calculated according to the mass-balance in the whole network such that

\begin{equation}
\label{massbalance_identification}
 \sigma_k = 1^T \hat{d}_k + 1^T \bar{d}_{\mathcal{K},k}.
\end{equation}

 In \eqref{massbalance_identification}, we assume that the flows in the WTs are measured, as the demand flows $\bar{d}_{\mathcal{D},k} $ in the network are not measurable. 

 % Nevertheless, the input and output set together forms the TS $\mathcal{D}_1 = \{u_i ; \tilde{y}_i\}_{i = 1,2, ..., N}$, which can be utilized to carry out the identification on the model.

 \subsection{State equation}
\label{state_eq_identification} 

The state equation is a first-order system of ODEs, which has been formulated on the pressures $\hat{p}$ in the WTs. In order to give a discretization for the approximate solution of the ODEs, Euler-method is used. The Euler-method is the simplest Runge-Kutta method, which provides an acceptable precision for our problem\cite{chicone2006ordinary}. Thus, the discretized state equation yields as follows

\begin{equation}
  \label{WT_matrixform_final_discrete}
\Lambda \frac{1}{T_s} (\hat{p}_{k+1} - \hat{p}_k)  = - (\hat{H}_{\mathcal{C}} - \hat{H}_{\mathcal{T}} \bar{H}^{-1}_{\mathcal{T}}\bar{H}_{\mathcal{C}})  q_{\mathcal{C},k} - \hat{H}_{\mathcal{T}} \bar{H}^{-1}_{\mathcal{T}} K \bar{d}_{\mathcal{K},k} + \hat{H}_{\mathcal{T}} \bar{H}^{-1}_{\mathcal{T}} D v_{\mathcal{D}} \sigma_k.
\end{equation}

\begin{minipage}[t]{0.20\textwidth}
where\\
\hspace*{8mm} $T_s$
\end{minipage}
\begin{minipage}[t]{0.68\textwidth}
\vspace*{2mm}
 is the sampling time.
\end{minipage}
\begin{minipage}[t]{0.10\textwidth}
\vspace*{2mm}
\textcolor{White}{te}$\unit{h}$
\end{minipage} 

Substituting the expression for $q_{\mathcal{C}}$ into \eqref{WT_matrixform_final_discrete}, and expressing the predicted values of the WT pressures on the left-hand side, the following yields

\vspace{-4mm}
\begin{align}
\label{WT_matrixform_final_discrete1}
\nonumber  \hat{p}_{k+1}  =& T_s \Lambda^{-1} \big(- (\hat{H}_{\mathcal{C}} - \hat{H}_{\mathcal{T}} \bar{H}^{-1}_{\mathcal{T}}\bar{H}_{\mathcal{C}})  q_{\mathcal{C},k}\big ((\hat{p}_k + \hat{h}),\bar{d}_{\mathcal{K},k}, \sigma_k \big) \\ & - \hat{H}_{\mathcal{T}} \bar{H}^{-1}_{\mathcal{T}} K \bar{d}_{\mathcal{K},k} + \hat{H}_{\mathcal{T}} \bar{H}^{-1}_{\mathcal{T}} D v_{\mathcal{D}} \sigma_k \big) + \hat{p}_k .
\end{align}
\vspace{-4mm}


The state equation in \eqref{WT_matrixform_final_discrete} describes the relation between the the flows $q_{\mathcal{C},k}$, the total head in the WTs $(\hat{p}_k + \hat{h})$ and the total consumption $\sigma_k$. However, by substituting the $q_{\mathcal{C},k}$ flows with their non-linear expression, the structure of the state equation is not a linear combination of the corresponding signals anymore. Therefore, let us write \eqref{WT_matrixform_final_discrete1} in a form where the non-linear terms are described by a non-linear $\tilde{f}_2(\cdot)$ function with unknown structure. Thus, a reformulated state equation can be given such that

 \begin{equation}
  \label{WT_matrixform_final_discrete2}
     \hat{p}_{k+1}  = \tilde{f}_2 \big((\hat{p}_k + \hat{h}),\bar{d}_{\mathcal{K},k}, \sigma_k\big) + \tilde{a}_2 \bar{d}_{\mathcal{K},k} + \tilde{a}_3 \sigma_k + \hat{p}_k,
\end{equation} 


where $\tilde{f}_2$ is a non-linear function, $\tilde{a}_2$ and $\tilde{a}_3$ are parameters of the inlet flows $\bar{d}_{\mathcal{K},k}$ and total consumption $\sigma_k$. 


\section{RBFNN model of the Multi-inlet,Multi-WT system}
\label{RBFNN_model_multi_inlet_multi_WT_sys} 

As a result of substituting the constraints on the flows $q_{\mathcal{C},k}$, the system description has been reduced to a non-linear State Space model with state equation given in \eqref {WT_matrixform_final_discrete2} and output equation in \eqref {recall_output_eq_3}. The complete identification model is summarized in \eqref{identification_model}. 

\begin{equation}
\begin{cases}
  \label{identification_model}
    \hat{p}_{k+1}  = \tilde{f}_2 \big((\hat{p}_k + \hat{h}),\bar{d}_{\mathcal{K},k}, \sigma_k\big) + \tilde{a}_2 \bar{d}_{\mathcal{K},k} + \tilde{a}_3 \sigma_k + \hat{p}_k,\\
  \bar{p}_{\mathcal{K},k}  = \tilde{f}_1 \big((\hat{p}_k + \hat{h}),\bar{d}_{\mathcal{K},k}, \sigma_k\big) + \tilde{a}_{\mathcal{K}} (\hat{p}_k + \hat{h}) - \bar{h}_{\mathcal{K}}.
  \end{cases}
\end{equation} 

The main goal of the system identification is to find a realization of the functions $\tilde{f}_1(\cdot)$ and $\tilde{f}_2(\cdot)$, furthermore to find the parameters $\tilde{a}_1$, $\tilde{a}_2$ and $\tilde{a}_3$. Therefore, the parameters need to be identified, such that the model is able to reproduce the approximate of the state derivatives $(\hat{p}_{k+1} - \hat{p}_k)$ and the total inlet head $\bar{p}_{\mathcal{K},k} + \bar{h}_{\mathcal{K}}$ from any input set $u_k = ( \hat{p}_k\! + \!\hat{h} \ \bar{d}_{\mathcal{K},k} \ \sigma_k )^T$ within the operating regions where we are mapping from.

The identification model shown in \eqref{identification_model} is an abstraction of the first principle model derived in \chapref{system_modelling}. For the constraint on $q_{\mathcal{C},k}$, existence has been implied, however exact structure has not been given. I.e. we know that the relationship exists but an analytical first principle solution for $q_{\mathcal{C},k}$ has not been derived. Therefore, by substituting the implicit expression of the constraint into the state and output equations, some of the insights on the structure of the model are lost. Thus, it is crucial to put a structure on the non-linear functions $\tilde{f}_1(\cdot)$ and $\tilde{f}_2(\cdot)$ in \eqref{identification_model}. 

From a practical point of view, it is beneficial to describe the system by a linear-in-the-parameters model. By restricting ourselves such that the structure of both functions $\tilde{f}_1(\cdot)$ and $\tilde{f}_2(\cdot)$ are linear in the parameters, the parameters of the model can be estimated by simple linear optimization methods, such as Least Squares(LS). For any linear optimization, only the parameters have to enter linearly, as the inputs can depend on any non-linear way on the input data sets. 

By making the restriction on $\tilde{f}_1(\cdot)$ and $\tilde{f}_2(\cdot)$, the two non-linear terms will be approximated by some non-linear functions in both the state and output equations of the model. The tools for carrying out such identification procedure leads to the discussion of Radial Basis Functions(RBFs) and neural networks, which are introduced in \appref{neural_networks}. In \appref{neural_networks}, the main properties of such networks are explained in detail, therefore during the construction of the identification model, these properties are used and applied. 

 \subsection{Output RBFNN}
\label{output_rbfnn}

The output equation described in \eqref{identification_model} is going to be approximated with RBFs in the form as shown in \eqref{output_RBFNNnetwork_approx} for two pressure inlets.

\vspace{-2mm}

\begin{subequations}
\label{output_RBFNNnetwork_approx}
  \begin{equation}
\bar{p}_{\mathcal{K}1,k} = \sum_{i = 1}^M w_{\mathcal{K}1,i} \phi_i(u_k) + \sum_{j = 1}^l \tilde{a}_{\mathcal{K}1,j} (\hat{p}_{j,k} + \hat{h}_j) + b_{\mathcal{K}1} - \bar{h}_{\mathcal{K}1},
\end{equation}

\vspace{-2mm}

  \begin{equation}
\bar{p}_{\mathcal{K}2,k} = \sum_{i = 1}^M w_{\mathcal{K}2,i} \phi_i(u_k) + \sum_{j = 1}^l \tilde{a}_{\mathcal{K}2,j} (\hat{p}_{j,k} + \hat{h}_j) + b_{\mathcal{K}2} - \bar{h}_{\mathcal{K}2},
\end{equation}

\end{subequations}

where $\bar{p}_{\mathcal{K},k} = (\bar{p}_{\mathcal{K}1,k} \ \bar{p}_{\mathcal{K}2,k})^T$ is the inlet pressure vector, $w_{\mathcal{K}1,i}$ is the output weight of the $i^{th}$ RBF neuron $\phi_i(u_k)$ , $\tilde{a}_{\mathcal{K}} = (\tilde{a}_{\mathcal{K}1} \ \tilde{a}_{\mathcal{K}2})^T$ is the parameter vector of the linear terms, $b_{\mathcal{K}} = (b_{\mathcal{K}1} \ b_{\mathcal{K}2})^T$ is the bias vector and $h_{\mathcal{K}} = (h_{\mathcal{K}1} \ h_{\mathcal{K}2})^T$ a constant vector which describes the elevation of the pumping stations. Furthermore, $l$ is the number of WTs and $M$ is the number of RBFs with which the non-linear terms are approximated. 

The NN model for the inlet pressure $\bar{p}_{\mathcal{K}1,k}$ is shown in \figref{fig:nn_output}, with the corresponding parameters and weighs.

  %NN model of the output eq.
 \begin{figure}[H]
 \centering
 %\includegraphics[width=0.35\textwidth]{report/pictures/missingfigure}
 \input{report/tikz/output_NN1.tex} 
  \vspace{-7mm}
 \caption{NN identification model of the total inlet head $\bar{p}_{\mathcal{K}1,k} + \bar{h}_{\mathcal{K}1}$.}
 \label{fig:nn_output}
 \end{figure}

 \vspace{-3mm}

 In \figref{fig:nn_output}, the first layer consists of the input vectors. The hidden layer consists of the set of RBFs and one linear neuron. The linear neuron defines a skip-layer connection in the model. This extra connection allows us to introduce the linear terms in our identification model, thereby letting  $\hat{p}_{k} \!+\! \hat{h}$ directly influence the output. 

 Furthermore, the output layer consists of the output neuron which computes $\bar{p}_{\mathcal{K}1,k}$ by summing the weighted RBFs, the weighted linear signals, the output bias and the elevation constant. For convenience, the elevation constants are added to the measured pressure inlets $\bar{p}_{\mathcal{K}1,k}$ in the identification. Thus, identification for the total inlet head vector $\bar{p}_{\mathcal{K1},k} \! + \! \bar{h}_{\mathcal{K1}} $ is carried out according to \eqref{inletpressures_ident_matrix}

  \begin{equation}
\label{inletpressures_ident_matrix}
\bar{p}_{\mathcal{K}1,k} + \bar{h}_{\mathcal{K}1} = \theta^T_{\mathcal{K}1} \chi(u_k),
\end{equation}

where the parameter vector $\theta_{\mathcal{K}1}$ and regression vector $\chi$ is given such that

  \begin{equation}
\label{par_regr_matrix}
\theta_{\mathcal{K}1} = 
          \begin{pmatrix}
           w_{\mathcal{K}1,1}  \\[1pt]
           \vdots  \\[1pt]
           w_{\mathcal{K}1,M}  \\[1pt]
           \tilde{a}_{\mathcal{K}1,1} \\[1pt]
           \vdots \\[1pt]
           \tilde{a}_{\mathcal{K}1,l} \\[1pt]
           b_{\mathcal{K}1} \\[1pt]
         \end{pmatrix}
         ,
         \hspace{5mm}
         \chi = 
         \begin{pmatrix}
           \phi_{1}(u_k)  \\[1pt]
           \vdots  \\[1pt]
           \phi_{M}(u_k)  \\[1pt]
           \hat{p}_{1,k} \!+ \!\hat{h}_1 \\[1pt]
           \vdots  \\[1pt]
           \hat{p}_{l,k} \!+ \!\hat{h}_1 \\[1pt]
           1 \\[1pt]
         \end{pmatrix}.
\end{equation}

With a given input measurements $u_k$ and inlet pressure measurements $\bar{p}_{\mathcal{K}1,k}$, the optimal solution for the parameters is calculated by using LS method, as \eqref{inletpressures_ident_matrix} is a linear matrix equation. Thus, the parameter matrix is given by \eqref{inletpressures_ident_matrix1}

  \begin{equation}
\label{inletpressures_ident_matrix1}
 \theta^T_{\mathcal{K}1} = (\bar{p}_{\mathcal{K}1,k} + \bar{h}_{\mathcal{K}1}) \chi^{\dagger}(u_k), 
\end{equation}

where the Moore-Penrose pseudoinverse of the regression vector is computed.  

In case of $c$ pumping stations, the inlet pressure vector $\bar{p}_{\mathcal{K},k}$ is given as shown in \eqref{complete_output_parameter_eq}

 \begin{equation}
\label{complete_output_parameter_eq}
         \begin{pmatrix}
           \bar{p}_{\mathcal{K}1,k} + \bar{h}_{\mathcal{K}1} \\[1pt]
           \vdots\\[1pt]
           \bar{p}_{\mathcal{K}c,k} + \bar{h}_{\mathcal{K}c} \\[1pt]
         \end{pmatrix}
         =
          \begin{pmatrix}
           \theta_{\mathcal{K}1} & \! \hdots \! & \theta_{\mathcal{K}c} \\[1pt]
         \end{pmatrix}^T
\chi(u_k).
\end{equation}
 \subsection{State RBFNN}
\label{state_rbfnn}

The state equation, described in \eqref{identification_model} is going to be approximated with RBFs in the same way as it has been done for the inlet pressures. Therefore, the approximate of the state derivative $\hat{p}_{k+1} \!-\! \hat{p}_k$ of Tank $A$ and Tank $B$ is given in the form as shown in \eqref{state_der_ident_approx}

\begin{subequations}
\label{state_der_ident_approx}

\begin{equation}
\hat{p}_{\mathcal{S}1,k+1} - \hat{p}_{\mathcal{S}1,k} = \sum_{i = 1}^N w_{\mathcal{S}1,i} \phi_i(u_k) + \sum_{j = 1}^c \tilde{a}_{\mathcal{S}1_A,j} \bar{d}_{\mathcal{K}j,k} + \tilde{a}_{\mathcal{S}1_B} \sigma_k + b_{\mathcal{S}1},
\end{equation}

\vspace{-2mm}

\begin{equation}
\hat{p}_{\mathcal{S}2,k+1} - \hat{p}_{\mathcal{S}2,k} = \sum_{i = 1}^N w_{\mathcal{S}2,i} \phi_i(u_k) + \sum_{j = 1}^c \tilde{a}_{\mathcal{S}2_A,j} \bar{d}_{\mathcal{K}j,k} + \tilde{a}_{\mathcal{S}2_B} \sigma_k + b_{\mathcal{S}2},
\end{equation}

\end{subequations}

where $w_{\mathcal{S}1,i}$ is the weight of the $i^{th}$ RBF, $\tilde{a}_{\mathcal{S}1_A,j}$ is the parameter of the $j^{th}$ inlet flow and $\tilde{a}_{\mathcal{S}1_B}$ is the parameter of the linear total demand. Furthermore, $N$ is the number of RBFs with which the non-linear terms are approximated and $c$ is the number of pumping stations. 

The NN model for the state derivative approximate of one tank $\hat{p}_{\mathcal{S}1,k+1} \! - \! \hat{p}_{\mathcal{S}1,k}$, with the corresponding weight and parameters is shown in \figref{fig:nn_state}.

   %NN model of the state eq.
 \begin{figure}[H]
 \centering
 %\includegraphics[width=0.35\textwidth]{report/pictures/missingfigure}
 \input{report/tikz/output_NN.tex} 
 \caption{NN model of the state derivative approximate $\hat{p}_{\mathcal{S}1,k+1} \! - \! \hat{p}_{\mathcal{S}1,k}$.}
 \label{fig:nn_state}
 \end{figure}

 \vspace{-3mm}

The identification of the state derivative approximate is carried out according to \eqref{statederiv_ident_matrix}

  \begin{equation}
\label{statederiv_ident_matrix}
\hat{p}_{\mathcal{S}1,k+1} - \hat{p}_{\mathcal{S}1,k} = \theta_{{\mathcal{S}1}} \chi(u_k),
\end{equation}

where the parameter vector $\theta_{{\mathcal{S}1}}$ and regression vector $\chi$ is given such that

  \begin{equation}
\label{par_regr_matrix1}
\theta_{\mathcal{S}1} = 
          \begin{pmatrix}
           w_{\mathcal{S}1,1}  \\[1pt]
           \vdots  \\[1pt]
           w_{\mathcal{S}1,N}  \\[1pt]
           \tilde{a}_{\mathcal{S}1_A,1} \\[1pt]
           \vdots \\[1pt]
           \tilde{a}_{\mathcal{S}1_A,c} \\[1pt]
           \tilde{a}_{\mathcal{S}1_B} \\[1pt]
           b_{\mathcal{S}1} \\[1pt]
         \end{pmatrix}
         ,
         \hspace{5mm}
         \chi = 
         \begin{pmatrix}
           \phi_{1}(u_k)  \\[1pt]
           \vdots  \\[1pt]
           \phi_{N}(u_k)  \\[1pt]
           \bar{d}_{\mathcal{K}1,k} \\[1pt]
           \vdots  \\[1pt]
           \bar{d}_{\mathcal{K}c,k} \\[1pt]
           \sigma_k \\[1pt]
           1 \\[1pt]
         \end{pmatrix}.
\end{equation}

The parameter matrix is computed equivalently as for the output equation with the Moore-Penrose pseudoinverse of the regression vector, shown in \eqref{inletpressures_ident_matrix1111}.

  \begin{equation}
\label{inletpressures_ident_matrix1111}
 \theta^T_{\mathcal{S}1} = (\hat{p}_{\mathcal{S}1,k+1} - \hat{p}_{\mathcal{S}1,k})  \chi^{\dagger}(u_k). 
\end{equation}

In case of $l$ WTs, the state derivative approximates $\hat{p}_{\mathcal{S}2,k+1}\! -\! \hat{p}_{\mathcal{S}2,k}$ are given as shown in \eqref{complete_state_parameter_eq}

\begin{equation}
\label{complete_state_parameter_eq}
         \begin{pmatrix}
           \hat{p}_{\mathcal{S}1,k+1} - \hat{p}_{\mathcal{S}1,k} \\[1pt]
           \vdots\\[1pt]
           \hat{p}_{\mathcal{S}l,k+1} - \hat{p}_{\mathcal{S}l,k} \\[1pt]
         \end{pmatrix}
         =
          \begin{pmatrix}
           \theta_{\mathcal{S}1} & \! \hdots \! & \theta_{\mathcal{S}l} \\[1pt]
         \end{pmatrix}^T
\chi(u_k).
\end{equation}

\section{Identification of the Randers WSS}
\label{identification_of_the_randers_WSS} 

abcd

